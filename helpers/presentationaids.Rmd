---
title: "presentation aids"
author: "Tiffany Jann"
date: ""
output: 
  html_document:
    fig_height: 3
    fig_width: 5
---
<!-- Don't edit in between this line and the one below -->
```{r include=FALSE}
# Don't delete this chunk if you are using the DataComputing package
library(DataComputing)

```
*Source file* 
```{r, results='asis', echo=FALSE}
includeSourceDocuments()
```
<!-- Don't edit the material above this line -->
```{r}
options(scipen=999)
```

Variable inputs:
```{r}
#Determine how many points you want to look at
alpha <- 10
#Gold Standard Network
goldFile <- "wk2fivefmriCS100S20N3000.csv"
#Discretized Results
method <- "wk2five_mean.csv"
```

Helper: reads and transposes data table
```{r}
read.tcsv = function(file, header=TRUE, sep=",", ...) {

  n = max(count.fields(file, sep=sep), na.rm=TRUE)
  x = readLines(file)

  .splitvar = function(x, sep, n) {
    var = unlist(strsplit(x, split=sep))
    length(var) = n
    return(var)
  }

  x = do.call(cbind, lapply(x, .splitvar, sep=sep, n=n))
  x = apply(x, 1, paste, collapse=sep) 
  out = read.csv(text=x, sep=sep, header=header)
  return(out)

}
```

Load and normalize original network
```{r}
raw <- read.tcsv(goldFile, header=FALSE)[1:alpha,]
raw <- na.omit(raw)
head(raw)


time <- c(1:nrow(raw))
value1 <- raw$V1

df <- data.frame(time, value1)
df
df %>% ggplot(aes(x = time, y = value1)) +  geom_point(color="red")


#Vertical shift
print(min(raw))
vshift <- raw - min(raw)
head(vshift)
#Should be 0
print(min(vshift))

value2 <- vshift$V1

df <- data.frame(time, value1, value2)
df <- df %>% gather(stage, value, c(value1, value2))
df %>% ggplot(aes(x = time, y = value)) + geom_point(aes(color=stage)) + scale_color_manual(values=c("red", "blue")) + theme(legend.position="none")

df <- data.frame(time, value1, value2)
df %>% ggplot(aes(x = time, y = value2)) + geom_point(color="blue")

#Scaling to unit length
scaled <- vshift / (max(vshift) - min(vshift))

#Normalized original
head(scaled)
print(min(scaled))
print(max(scaled))

value3 <- scaled$V1

df <- data.frame(time, value2, value3)
df <- df %>% gather(stage, value, c(value2, value3))
df %>% ggplot(aes(x = time, y = value)) + geom_point(aes(color=stage)) + scale_color_manual(values=c("blue", "green")) + theme(legend.position="none")

df <- data.frame(time, value2, value3)
df %>% ggplot(aes(x = time, y = value3)) + geom_point(color="green")
```

Load a discretization output
```{r}
discretized <- read.tcsv(method, header=TRUE)[1:alpha,]
rownames <- discretized[,1]
discretized <- na.omit(discretized[,-1])
colnames(discretized) <- c("V1", "V2", "V3", "V4", "V5")
head(discretized)
```

<!-- Create a plottable data frame with all necessary information -->
<!-- ```{r} -->
<!-- binary <- discretized$Gene1 -->
<!-- df <- data.frame(time, value3, binary) -->
<!-- df <- df %>% gather(stage, value, c(value3, binary)) -->
<!-- df %>% ggplot(aes(x = time, y = value)) + geom_point(aes(color=stage)) + scale_color_manual(values=c("orange", "green")) + theme(legend.position="none") -->
<!-- ``` -->

<!-- Plot data frame -->
<!-- ```{r} -->
<!-- df %>% ggplot(aes(x = time, y = value, group=1)) + facet_wrap(~ datatype) + geom_point() + geom_line() + geom_area() -->
<!-- ``` -->

<!-- Overlay plot -->
<!-- ```{r} -->
<!-- df %>% ggplot(aes(x = time, y = value)) + geom_point(aes(color=datatype)) -->
<!-- ``` -->


<!-- Using *exact* trapezoid rule to find area -->
<!-- ```{r} -->
<!-- binaryArea <- sum(binary[2:(length(raw) - 1)]) + (binary[1] + binary[length(raw)]) / 2 -->

<!-- rawArea <- sum(raw[2:(length(raw) - 1)]) + (raw[1] + raw[length(raw)]) / 2 -->
<!-- ``` -->

<!-- Compare areas -->
<!-- ```{r} -->
<!-- binaryArea -->
<!-- rawArea -->
<!-- ``` -->